---
title: "Simple Linear Regression"
output: html_notebook
---

**Зад. 1** Твърди се, че съществува следната връзка между максималния пулс на сърцето и възрастта: Пулс = 220 - възраст.  
Петнадесет човека на различна възраст са тествани за максимален пулс. Получени са следните наблйдения: ** TODO: Table**  
Постройте линеен модел описващ данните. Проверете дали коефициентите в този модел съвпадат с първоначалната хипотеза. Намерете максималният пулс, който би достигнал човек на възраст 30, 40 или 50 год. Постройте 90% доверителен интервал за този пулс. Начертайте доверителните интервали.

```{r}
age = c(18, 23,25, 35, 65, 54, 34, 56, 72, 19, 23, 42, 18, 39, 37)
pulse = c(202, 186, 187, 180, 156, 169, 174, 172, 153, 199, 193, 174, 198, 183, 178)

l = lm(pulse ~ age)
plot(age, pulse)
abline(l)

summary(l)
```

> Проверяваме хипотезата:  
> H0: B1 = -1  
> H1: B1 != -1

```{r}
s = summary(l)
beta1 = s$coefficients[2, 1]
se = s$coefficients[2, 2]
t = (beta1 + 1)/se
t

pval = 2*(1 - pt(t, df=13))
pval
```
> p-value < 0.05 => отхвърляме H0 и приемаме Beta1 != -1

```{r}
dat = data.frame(age=c(30, 40, 50))
predict.lm(l, dat,interval='confidence', level=0.9)
```

---

**Зад. 2** Разгледайте данните 'mtcars'. Потърсете променливи, между които има линейна връзка. Как влияе обема на двигателя върху разхода на гориво и върху мощността? Направете отделни изследвания за 4 и 8 цилиндровите двигатели.

```{r}
plot(mtcars)

displacement = mtcars[,3] 
consumption = mtcars[,1] 
horsepower = mtcars[,4] 

plot(displacement, consumption)
```
> Разход = b1*обем на двигателя + b0  
> b1 = ?

```{r}
plot(displacement, consumption)
l = lm(consumption ~ displacement)
abline(l)
coef(summary(l))
```
> b1 = -0.04121512  
> b0 = 29.59985476

---

**Зад. 3** В дванадесет ферми в Тексас са измервани валежите в cm/m2 през лятото, а също и реколтата от памук в килограми на декар. Резултатите са в таблицате. Каква е очакваната реколта за ферма, в която валежите са били 10cm/m2? Можем ли да твърдим, че увеличаване на валежите с 1cm/m2 води до нарастване на реколтата с поне 24 килограма на декар?

```{r}
x = c(8.9, 6.4, 12.8, 9.6, 13.8, 16.1, 12.4, 12.8, 11.8, 16.0, 7.4, 12.5)
y = c(306.2, 272.5, 385.0, 392.5, 400.0, 531.2, 415.0, 407.5, 373.7, 493.7, 325.0, 400.0)

plot(x, y)
l = lm(y~x)
abline(l)
summary(l)

d = data.frame(x = c(10))
predict.lm(l, d)
```
> Y = 139.31 + 21.57X  

> H0: b1 = 24  
> H1: B1 > 24

> t = (b1 - 24) / SEb1

```{r}
cf = coef(summary(l))
t = (cf[2,1] - 24) / cf[2,2]

1 - pt(t, df=length(x) - 2)
```
> p-value = 0.7938708 => H0 и не можем да твърдим че води до увеличаване.
