---
title: "R Notebook"
output: html_notebook
---

<strong>Зад. 1</strong> Напишете функция, която симулира 100 хвърнляния на зар и пресмята броя на падналите се шестици. 
```{r}
roll <- function() {
  return(rbinom(1, 100, 1/6))
}
```

Изпълнете функцията <em>n</em> пъти и въз основа на получените данни сметнете емпиричната вероятност да се падне шестица.
```{r}
p <- function(n = 100) {
  observations = c()
  for(i in 1:n) {
    observations[i] = roll()
  }
  
  return (sum(observations) / (n * 100))
}


p()

```

Постройте графика, която да илюстрира сходимостта на емпиричната вероятност към теоретичната.
```{r}
probabilities = function(n = 100) {
  r = c()
  
  for(i in 1:n) {
    r[i] = p(i)
  }
  
  return(r)
}

x = probabilities(500)

plot(x, type = 'l')
abline(h = 1/6, col = 'red' )
```



<strong>Зад. 2</strong> Напишете функция, която по дадено число <em>p∈(0,1)</em> пресмята колко човека трябва да изберете по случаен начин, така че вероятността рождените дни на поне двама от тях да съвпадата да е по-голяма от p.
```{r}
birthdays <- function( p = 0.5 ){
  prob = 1;
  for(i in 1:365) {
    prob = prob * (366-i) / 365
    if(prob < 1 - p) break
  }
  return(i)
}

birthdays()

```

<strong>Зад. 3</strong> Момче играе с майка си и баща си на тенис. Те ще изиграят точно 3 сета, като родителите се редуват, т.е има две възможности за момчето да играе: <br>
А) Първо с майка си, после с баща си и пак с майка си. <br>
Б) Първо с баща си, после с майка си и пак с баща си. <br>

Момчето печели когато победи в две последователни игри. Ако момчето побеждава баща си с вероятност <em>p<sub>1</sub></em>, а майка си с <em>p<sub>2</sub></em>, като <em>p<sub>1</sub> < p<sub>2</sub></em>, кой вариант му е по-изгоден? Пресметнете емпиричната и теоретичната вероятност при <em>p<sub>1</sub>=0.3 и p<sub>2</sub>=0.4</em>

```{r}
p1 = 0.3
p2 = 0.4

# TODO :)

```

<strong>Зад. 4</strong> Нека 'Е' и 'Т' са съответно падане на ези и тура при хвърляне на монета. Напишете функция, която пресмята емпирично колко хвърляния са необходими до падането на последователност 'ЕЕТЕТ'.
```{r}
letters = c('E', 'T')

count_flips <- function(target) {
  count = 1
  
  while(TRUE) {
    current = sample(letters, length(target), TRUE)
    
    if(identical(current, target)) {
      break
    }
    
    count = count + 1
  }
  
  
  return(count)
}


count_flips(c('E', 'E', 'T', 'E', 'T'))

```

