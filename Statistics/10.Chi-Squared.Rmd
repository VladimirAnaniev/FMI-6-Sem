---
title: "Chi-Squared"
output: html_notebook
---

**Зад.1** Резултатите получени при 150 хвърляния на зар са в следната таблица 
| Точки | 1 | 2 | 3 | 4 | 5 | 6 |
|:-------|:--:|:--:|:--:|:--:|:--:|:--:|
| Честота | 22 | 21 | 22  |27 | 22 | 36 |  
Можем ли да приемем, че зарът е правилен?

> H0: p = 1/6  
> H1: p != 1/6  
> EXi = 150*1/6 = 25 очакване за всеки интервал

```{r}
x = c(22, 21, 22, 27, 22, 36)
chisq.test(x)
```
> p-value > 0.05 => приемаме Х0 и зарът е правилен.

---

**Зад. 2** В променливата pi2000 са първите 2000 цифри на числото Pi. Разгледайте първите 200 цифри. Можем ли да приемем, че всяка цифра се среща с една и съща вероятност?

```{r}
pi2000[1:200]
counts = table(pi2000[1:200])
counts
chisq.test(counts)
```
> p-value > 0.05 => приемаме, че цифрите се срещат с еднаква вероятност.

---

**Зад. 3** Честотата на срещането на буквите в английски език е както следва:  

| Буква | E | T | A | O | I | N | ... |
|:-----|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Честота | 12.7% | 9.56% | 8.17% | 7.51% | 6.97% | 6.75% | 48.34% |  

Анализиран е текст от 1036 букви и се оказва, че в него броят срещания на тези букви е съответно  

| Буква | E | T | A | O | I | N |
|:-----|:--:|:--:|:--:|:--:|:--:|:--:|
| Честота | 102 | 108 | 90 | 95 | 82 | 40 |  

На английски ли е текстът?

```{r}
occurrences = c(102, 108, 90, 95, 82, 40)
occurrences = append(occurrences, 1036 - sum(occurrences))
occurrences

p = c(12.7, 9.56, 8.17, 7.51, 6.97, 6.75, 48.34)/100
p

chisq.test(occurrences, p=p)
```
> p-value < 0.05 => не е английски

---

**Зад 4** В таблицата са дадени данни за пострадалите при катастрофи пътници в зависимост от поставянето на предпазен колан.

| Наранявания | Без | Леки | Средни | Тежки |
|:---|:--:|:--:|:--:|:--:|
|С колан| 12813 | 647 | 359 | 42|
|Без колан| 65963 | 4000 | 2642 | 303 |  

Можем ли да твърдим, че предпазните колани намаляват вероятността за поражения при водачите?  
> Имаме 2 разпределения, X i Y (със и без колан)
> H0: X === Y
> H1: X !== Y

```{r}
belt = c(12813, 647, 359, 42)
wobelt = c(65963, 4000, 2642, 303)
m = matrix(c(belt,wobelt), nrow = 2, byrow = T)
m

#prop.table(m) sum all = 1
#prop.table(m, 1) sum row = 1

chisq.test(m)
```
> p-value < 0.05 => X !== Y и коланите влиаят на пораженията

---

**Зад. 5** Предполага се, че съществува връзка между качеството на стоката и деня на седмицата, в който е произведена. Иземени са 500 прдукта.
**TODO: Table :)**  
Потвърждава ли се твърдението?  
>

```{r}
x = matrix(c(44,74,79,72,31,14,25,27,24,10,15,20,20,23,9,3,5,5,0,0), ncol=5, byrow=T)
x
chisq.test(x)
```
> p-value > 0.05 => денят не влияе на качеството :)

---

**Зад.6** Разгледайте данниете във файл 'data.txt.' Можем ли да приемем, че те са експоненциално разпределени с параметър lambda=2?

> TODO :)





 