---
title: "Вероятности и Статистика  <br>
Домашно 2  <br>
Владимир Ананиев, 81459"
output: html_notebook
---

---

**Зад. 1** Таблицата 'morley' съдържа резултатите от пет експеримента за измерване на скоростта на светлината. Как са разпределени данните в четвъртия експеримент? Постройте 97% доверителен интервал по данните от него.

```{r}
library(UsingR)
attach(morley)
morley
```

```{r}
speed <- morley[Expt == 4, 'Speed']

boxplot(speed, horizontal = T)
hist(speed)
qqnorm(speed)
qqline(speed)
```
> Данните изглеждат нормално разпредени, ще направим Shapiro-Wilk тест за нормалност

```{r}
shapiro.test(speed)
```
> p-value > 0.5. Приемаме,че данните са нормално разпределени

```{r}
t.test(speed, conf.int = TRUE, conf.level=0.97)
```
> 97% Confidence Interval: [789.008 - 851.992]

---

**Зад. 2** Тества се ново лекарство за отслабване. Наблюдавани са 10 мишки, теглото им преди е било: *255, 258, 256, 201, 215, 207, 213, 215, 242, 216*, след употребата на лекарството е: *250, 263, 254, 200, 213, 200, 210, 211, 232, 210*. Вярно ли е, че лекарството води до отслабване?

```{r}
x = c(255, 258, 256, 201, 215, 207, 213, 215, 242, 216)
y = c(250, 263, 254, 200, 213, 200, 210, 211, 232, 210)

shapiro.test(x)
shapiro.test(y)
```
> Двете извадки не са нормално разпределени. 

> X - първоначалното тегло на мишките
> Y - теглото на мишките след приемане на лекарството  
> H0: Y = X  
> H1: Y < X

```{r}
wilcox.test(y, x, alternative = 'less', paired = TRUE)
```
> p-value < 0.05 => Приемаме H1 и лекарството води до отслабване.

---

**Зад. 3** По данните 'birthwt' от пакета 'MASS', можем ли да твърдим, че има връзка между тютюнопушененто и раждането на бебе под нормалните (2.5) кг? Проверете графично. Формулирайте и проверете хипотеза за това твърдение.

```{r}
birthwt
```

```{r}
smoker_babies = bwt[smoke == 1]
non_smoker_babies = bwt[smoke == 0]
boxplot(smoker_babies, non_smoker_babies, horizontal = TRUE, names=c('Smokers', 'Non-Smokers'))
```
>  Забелязва се, че средното тегло на децата на майките пушачи е по-ниско от това на непушачите. Също максималните стойности при майките непушачи достигат 5кг, докато при майките пушачи това е само 4.2кг.

```{r}
hist(smoker_babies)
hist(non_smoker_babies)
```
> Потвърждава се наблюдението, че най-слабите деца са родени от майки пушачи. Не се забелязва обаче по-голяма пропорция за бебета под нормалните килограми.

> Съставяме следната хипотеза:  
> Вероятността майка пушач да роди бебе под 2.5кг е равна на вероятността майка непушач да роди бебе под 2.5кг  
> Алтернативата гласи, че вероятността за майките пушачи е по-голяма  
> H0: Px = Py  
> H1: Px > Py

```{r}
smoker_all = length(bwt[smoke == TRUE])
smoker_underweight = length(bwt[smoke == TRUE & bwt < 2500])

non_smoker_all = length(bwt[smoke == FALSE])
non_smoker_underweight = length(bwt[smoke == FALSE & bwt < 2500])

prop.test(c(smoker_underweight, non_smoker_underweight), c(smoker_all, non_smoker_all), alternative = 'greater')
```
> p-value < 0.05 => приемаме H1 и можем да твърдим, че за майките пушачи е по-вероятно да родят бебе под 2.5кг