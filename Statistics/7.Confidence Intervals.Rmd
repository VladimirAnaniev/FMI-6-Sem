---
title: "Confidence Intervals"
output: html_notebook
---
<strong>Зад 1.</strong> Острата левкемия е една от най-смъртноносните форми на рак. Предишни изследвания показват, че впемето на преживяване след първоначалното откриване на левкемия е нормално разпределена случайна величина с математическо очакване 13 месеца и стандартно отклонение 3 месеца. Въвежда се ново лечение, което се очаква да удължи средното време на живот без да повлияе на дисперсията. Наблюдавани са 16 пациента:
10.0 13.6 13.2 11.6 12.5 14.2 14.9 14.5 13.4 8.6 11.5 16.0 14.2 16.8 17.9 17.0
Да се намери оценка за очакването. Да се построи 95% доверителен интервал за средното време на живот на болните.
```{r}
x = c(10.0, 13.6, 13.2, 11.6, 12.5, 14.2, 14.9, 14.5, 13.4, 8.6, 11.5, 16.0, 14.2, 16.8, 17.9, 17.0)

boxplot(x, horizontal = T)
hist(x)
qqnorm(x)
qqline(x)
shapiro.test(x)
```
> Приемаме, че данните са нормално разпределени

```{r}
t.test(x)
```
> 95 percent confidence interval: 12.39066 - 15.09684

---

**Зад. 2** Постройте 95% и 90% доверителен интервал за средното време на живот на болните.
```{r}
t.test(x, conf.level = 0.95)
t.test(x, conf.level = 0.90)
```

---

**Зад. 3** Генерирайте 20 нблюдения над случайна величина, която е нормално разпределена с очакване 5, и дисперсия 4. Постройте 90% процентен доверителен интервал за математическото очакване. Мовторете опита 100 пъти. Проверете в колко от случаите математическото очакване принадлежи на доверителния интервал.

```{r}
r = rnorm(20, 5, 2)
t.test(r, conf.level = 0.90)
```

```{r}
count = 0
for(i in 1:100){ 
  r = rnorm(20, 5, 2)
  t = t.test(r, conf.level = 0.90)
  if (5 < t$conf.int[2] & 5 > t$conf.int[1]) {
    count = count +  1
  }
}
count

```

---

**Зад. 5** При провеждане на анкета 87 от 150 анкетирани са отговорили, че са изплозвали даден продукт. Постройте 92% доверителен интервал за броя на хората, използвали продукта.
> x1, ..., x150
> xi <- Bi(1, p)

```{r}
prop.test(87, 150, conf.level = 0.92)
```

---
**Зад. 6** Постройте 96% доверителен интервал за средната стойност по данните:  
  **a)** rat  
  **b)** exec.pay  
  **c)** malpract

> t.test if X <- N  
> wilcox.test otherwise

```{r}
shapiro.test(rat)
t.test(rat, conf.level = 0.96)
```

```{r}
shapiro.test(exec.pay)
wilcox.test(exec.pay, conf.int = T, conf.level = 0.96)
```

```{r}
shapiro.test(malpract)
wilcox.test(malpract, conf.int = T, conf.level = 0.96)
```