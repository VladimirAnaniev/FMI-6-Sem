---
title: "R Exam 26.01.2019"
output: html_notebook
---
  
**1** Нека *а0, а1, ... , аn* е числова редица, за която *ak = 2(ak-1 + ak-2)*. Напишете функция, която по зададени *(a0, a1, n)* пресмята *аn*. Изчислете *an* и сумата на редицата, зададена с (1, 2, 20)
```{r}
f <- function (a0, a1, n) {
  if (n == 0) return(a0)
  else if (n == 1) return(a1)
  
  an1 = a0
  an = a1
  for (i in 2:n) {
    temp = 2*(an1 + an)
    an1 = an
    an = temp
  }
  
  return(an)
}

f(1, 2, 20)

sum = 0
for (i in 1:20) {
  sum = sum + f(1, 2, i)
}
sum
```

---

**2** Разглеждаме данните birthwt от пакета 'MASS' Определете  
- Колко са пушачките, родили бебе с тегло под 2.5кг
```{r}
birthwt
# x = birthwt[birthwt$smoke == TRUE & birthwt$bwt < 2500,]
# length(x$bwt)
sum(low & smoke)
```

- Представете с подходяща графика, пушенето и расата на жените.  
```{r}
table(smoke, race)
barplot(table(smoke, race))
```

---

**3** По данните от задача 2, можем ли да твърдим, че жените родили бебе под нормалните кг (2.5) са по-млади? Проверете графично. Формулирайте и проверете хипотеза за това твърдение.  
> H0: x = y  
> H1: x < y

```{r}
x = birthwt$age[low == 1]
y = birthwt$age[low == 0]

hist(x)
hist(y)

shapiro.test(x)
shapiro.test(y)
```
```{r}
wilcox.test(x, y, alternative = 'less')
```
> p-value = 0.1235 => приемаме H0 и Не можем да твърдим, че жените родили бебета под 2.5кг са по-млади

---

**4** От тесте с 52 карти теглим последователно, без връщане, докато уцелим асо. Нека *X* е броя на изтеглените карти. Симулирайте 200 опита, по събраните данни постройте 90% доверителен интервал за средната стойност на X.
```{r}
obs = rnhyper(200, 4, 52, 1)

```

Пресметнете теоретичната вероятност P(X = 10)
```{r}
p = 1
for (i in 0:9) {
  p = p * 4/(52 - i)
}
p
```

---

**Зад. 5** Героите във фантастичен сериал носят три цвята униформа според ранга - златиста, червена и черна. Съществува ли зависимост между ранга и честотата на ранявания и убийства на героите?

```{r}
no = c(43, 69, 123)
inj = c(12, 32, 35)
kil = c(8, 18, 44)



```
> H0: Раняванията са независими от ранга  
> H1: Има зависимост между раняванията и ранга

```{r}
m = matrix(c(no, inj, kil), nrow = 3, byrow=T)
m
chisq.test(m)
```
> p-value = 1.1249 => Приемаме H0 и няма зависимост между нараняванията и ранга.

---

**Зад. 6** Съвпада с 4 задача от домашното :)

